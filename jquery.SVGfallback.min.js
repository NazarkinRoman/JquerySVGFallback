/*! Author: Nazarkin Roman (http://nazarkin.su); Twitter: @nazarkin_roman; Version: 1.0; License: MIT; */
(function(a){jQuery.fn.svgFallback=function(e){e=a.extend({allowExternalImages:false,cachePrefix:"svgCache_",cacheEnabled:true,storage:sessionStorage},e);if(!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1")){return this}var h=function(){this.set=function(i,j){e.storage.setItem(e.cachePrefix+i,j);return true};this.get=function(i){return e.storage.getItem(e.cachePrefix+i)};this.remove=function(i){e.storage.removeItem(e.cachePrefix+i);return true};this.checkStorage=function(){try{return typeof e.storage=="object"&&typeof e.storage.setItem=="function"&&typeof e.storage.getItem=="function"&&typeof e.storage.removeItem=="function"}catch(i){return false}};if(!e.cacheEnabled||!this.checkStorage()){if(e.cacheEnabled){console.error("svgFallback: provided storage does not match signature")}this.set=function(i,j){return false};this.get=function(i){return null};this.remove=function(i){return null}}return this};var c=new h();var g=new RegExp("^(ht|f)tps?://([a-z0-9-\\.]+\\.[a-z]{2,4})/.*\\.png");var b=new RegExp("^/*([a-z0-9-\\.]+/)*[a-z0-9-\\.]+\\.png$");var d=function(i){i=a.trim(i);if(b.test(i)){return true}if(g.test(i)){var j=i.match(g);if(!e.allowExternalImages&&j[2]!==location.hostname){return false}}return true};var f={};this.each(function(k,l){var j=a(l).attr("src");if(!j||!d(j)){return}var i=j.replace(/(\.png)$/,".svg");var m=c.get(i);if(m=="false"){return}if(m=="true"){a(l).attr("src",i);a(l).error(function(){c.remove(i);a(this).attr("src",j)});return}if(typeof f[i]!="undefined"){f[i].push(l)}else{f[i]=[l]}});a.each(f,function(i,j){a.ajax({url:i,type:"HEAD",async:true,success:function(){a(j).attr("src",i);c.set(i,"true")},error:function(){c.set(i,"false")}})});return this}})(jQuery);